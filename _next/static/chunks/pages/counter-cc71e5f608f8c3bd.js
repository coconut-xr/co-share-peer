(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[94],{7343:function(e,a,t){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var a,t=1,n=arguments.length;t<n;t++)for(var s in a=arguments[t])Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s]);return e}).apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0}),a.connectPeer=void 0;var c=t(1687),o=t(8751),r=s(t(5232)),p=t(2937),i=t(9978),m=t(9223);a.connectPeer=function(e,a,t,s,k,N){return new Promise((function(u){var l=new r.default(e),d=e.observeStreams?(0,m.observeStreams)(l):l,b=new p.Subscription,g=function(){b.unsubscribe(),l.destroy(),s()};return b.add(a().pipe((0,i.tap)((function(e){return l.signal(e)}))).subscribe()),b.add((0,p.fromEvent)(l,"close").pipe((0,i.tap)(g)).subscribe()),b.add((0,p.fromEvent)(l,"error").pipe((0,i.tap)(g)).subscribe()),b.add((0,p.fromEvent)(l,"signal").pipe((0,i.tap)(t)).subscribe()),b.add((0,p.fromEvent)(l,"connect").pipe((0,i.tap)((function(){var e={disconnect:g,publish:function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return l.send((0,o.encode)(e))},receive:function(){return(0,p.fromEvent)(l,"data",(function(e){return e})).pipe((0,i.map)((function(e){return(0,o.decode)(e)})))},userData:n(n({},null==k?{}:k(d)),{instance:d})},a=N.link(c.RootStoreDefaultLinkId,e);u([e,a])}))).subscribe()),l}))}},3349:function(e,a,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,a,t,n){void 0===n&&(n=t);var s=Object.getOwnPropertyDescriptor(a,t);s&&!("get"in s?!a.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return a[t]}}),Object.defineProperty(e,n,s)}:function(e,a,t,n){void 0===n&&(n=t),e[n]=a[t]}),s=this&&this.__exportStar||function(e,a){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(a,t)||n(a,e,t)};Object.defineProperty(a,"__esModule",{value:!0}),s(t(9223),a),s(t(7343),a)},9223:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.observeStreams=a.isStreamingInstance=void 0;var n=t(2937),s=t(9978);a.isStreamingInstance=function(e){return"streamsObservable"in e},a.observeStreams=function(e){var a=new Set,t=(0,n.connectable)((0,n.fromEvent)(e,"stream",(function(e){return e})).pipe((0,s.mergeMap)((function(e){a.add(e);var t=e.getTracks();return n.merge.apply(void 0,t.map((function(e){return(0,n.fromEvent)(e,"mute")}))).pipe((0,s.take)(1),(0,s.map)((function(){return t.forEach((function(e){return e.stop()})),a.delete(e),a})),(0,s.startWith)(a))})),(0,s.takeUntil)((0,n.fromEvent)(e,"close")),(0,s.map)((function(e){return Array.from(e)})),(0,s.endWith)([])));return t.connect(),Object.assign(e,{streams:a,streamsObservable:t})}},8077:function(e,a,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,a,t,n){void 0===n&&(n=t);var s=Object.getOwnPropertyDescriptor(a,t);s&&!("get"in s?!a.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return a[t]}}),Object.defineProperty(e,n,s)}:function(e,a,t,n){void 0===n&&(n=t),e[n]=a[t]}),s=this&&this.__exportStar||function(e,a){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(a,t)||n(a,e,t)};Object.defineProperty(a,"__esModule",{value:!0}),s(t(2248),a),s(t(6448),a)},6448:function(e,a,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,a,t,n){void 0===n&&(n=t);var s=Object.getOwnPropertyDescriptor(a,t);s&&!("get"in s?!a.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return a[t]}}),Object.defineProperty(e,n,s)}:function(e,a,t,n){void 0===n&&(n=t),e[n]=a[t]}),s=this&&this.__exportStar||function(e,a){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(a,t)||n(a,e,t)};Object.defineProperty(a,"__esModule",{value:!0}),s(t(9992),a),s(t(6897),a)},6897:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.useIncommingPeerStreams=a.useIncommingPeerStreamsChange=void 0;var n=t(7378);function s(e,a){var t=(0,n.useMemo)((function(){return{ref:Array.from(e.streams)}}),[e]);(0,n.useEffect)((function(){var n=e.streamsObservable.subscribe({next:function(e){t.ref=e,a(t.ref)}});return function(){return n.unsubscribe()}}),[e,a,t])}a.useIncommingPeerStreamsChange=s,a.useIncommingPeerStreams=function(e){var a=(0,n.useState)([]),t=a[0];return s(e,a[1]),t}},9992:function(e,a,t){"use strict";var n=this&&this.__spreadArray||function(e,a,t){if(t||2===arguments.length)for(var n,s=0,c=a.length;s<c;s++)!n&&s in a||(n||(n=Array.prototype.slice.call(a,0,s)),n[s]=a[s]);return e.concat(n||Array.prototype.slice.call(a))};Object.defineProperty(a,"__esModule",{value:!0}),a.useOutgoingPeerStream=void 0;var s=t(7378);a.useOutgoingPeerStream=function(e,a){var t=(0,s.useRef)([]);(0,s.useEffect)((function(){return function(){if(!e.destroyed)for(var a=0,n=t.current;a<n.length;a++){var s=n[a];e.removeStream(s)}t.current=[]}}),[e]),(0,s.useEffect)((function(){for(var s=0,c=a;s<c.length;s++){var o=c[s];t.current.includes(o)||e.addStream(o)}for(var r=0,p=t.current;r<p.length;r++){var i=p[r];a.includes(i)||e.removeStream(i)}t.current=n([],a,!0)}),[a,e])}},2248:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.usePeerConnection=void 0;var n=t(1687),s=t(7378),c=t(4487),o=t(3349),r=Symbol();a.usePeerConnection=function(e,a,t,p,i,m){void 0===m&&(m=n.rootStore);var k=(0,c.suspend)((function(){return(0,o.connectPeer)(e,a,t,p,i,m)}),[e,a,t,i,m,r]),N=k[0],u=k[1];return(0,s.useEffect)((function(){return function(){return u.close()}}),[u]),N}},7017:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/counter",function(){return t(6760)}])},6673:function(e,a,t){"use strict";t.d(a,{$:function(){return o}});var n=t(4246),s=t(5675),c=function(e){var a=e.src;return"/co-share-peer".concat(a)};function o(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex-grow-1"}),(0,n.jsx)("footer",{className:"bg-light",children:(0,n.jsxs)("div",{className:"d-flex align-items-center justify-content-around p-3 container-lg",children:[(0,n.jsxs)("a",{target:"_blank",href:"https://github.com/cocoss-org/co-share-peer",className:"mx-2 text-black d-flex flex-row align-items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-github mx-2",viewBox:"0 0 16 16",children:(0,n.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"})}),(0,n.jsx)("span",{className:"h5 mb-0",children:"Github"})]}),(0,n.jsx)("a",{className:"d-flex mx-2",target:"_blank",href:"https://www.coconut-xr.com/",children:(0,n.jsx)(s.default,{loader:c,layout:"fixed",width:170,height:40,src:"/powered-by.svg"})})]})})]})}},1952:function(e,a,t){"use strict";t.d(a,{h:function(){return r}});var n=t(4246),s=t(5063),c=t(7378),o=[{title:"Counter",url:"/counter"},{title:"Stream",url:"/stream"}];function r(e){var a=e.selectedIndex,t=(0,c.useState)(!1),r=t[0],p=t[1];return(0,n.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:(0,n.jsxs)("div",{className:"container-fluid",children:[(0,n.jsx)(s.default,{href:"/",passHref:!0,children:(0,n.jsx)("a",{className:"navbar-brand",children:"co-share-peer examples"})}),(0,n.jsx)("button",{className:"navbar-toggler",type:"button",onClick:function(){return p(!r)},"data-bs-toggle":"collapse","data-bs-target":"#navbarNavDropdown","aria-controls":"navbarNavDropdown","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,n.jsx)("span",{className:"navbar-toggler-icon"})}),(0,n.jsx)("div",{className:"align-self-flex-end navbar-collapse ".concat(r?"":"collapse"),children:(0,n.jsx)("ul",{className:"navbar-nav",children:o.map((function(e,t){var c=e.title,o=e.url;return(0,n.jsx)("li",{className:"nav-item",children:t===a?(0,n.jsx)("span",{style:{cursor:"pointer"},className:"active nav-link",children:c}):(0,n.jsx)(s.default,{href:o,passHref:!0,children:(0,n.jsx)("a",{className:"nav-link",children:c})})},c)}))})})]})})}},6760:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return x}});var n=t(4246),s=t(8077),c=t(3545),o=t(7378),r=t(1687);function p(e){let a;const t=new Set,n=(e,n)=>{const s="function"===typeof e?e(a):e;if(s!==a){const e=a;a=n?s:Object.assign({},a,s),t.forEach((t=>t(a,e)))}},s=()=>a,c={setState:n,getState:s,subscribe:(e,n,c)=>n||c?((e,n=s,c=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=n(a);function r(){const t=n(a);if(!c(o,t)){const a=o;e(o=t,a)}}return t.add(r),()=>t.delete(r)})(e,n,c):(t.add(e),()=>t.delete(e)),destroy:()=>t.clear()};return a=e(n,s,c),c}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,a){return!a||"object"!==l(a)&&"function"!==typeof a?i(e):a}function u(e,a){return(u=Object.setPrototypeOf||function(e,a){return e.__proto__=a,e})(e,a)}var l=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function d(e){var a=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=k(e);if(a){var s=k(this).constructor;t=Reflect.construct(n,arguments,s)}else t=n.apply(this,arguments);return N(this,t)}}var b=function(e){!function(e,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),a&&u(e,a)}(c,e);var a,t,n,s=d(c);function c(e){var a;return function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,c),(a=s.call(this)).subscriber=r.Subscriber.create(c,(function(e,t,n){return t(a.state.getState().counter)})),a.increase=r.Action.create(i(a),"incr",(function(e){a.increase.publishTo(null==e?{to:"all"}:{to:"all-except-one",except:e}),a.state.setState({counter:a.state.getState().counter+1})})),a.state=p((function(){return{counter:e}})),a}return a=c,(t=[{key:"onUnlink",value:function(e){}},{key:"onLink",value:function(e){}}])&&m(a.prototype,t),n&&m(a,n),c}(r.Store),g=t(7772);function j(e){let a;const t=new Set,n=(e,n)=>{const s="function"===typeof e?e(a):e;if(s!==a){const e=a;a=n?s:Object.assign({},a,s),t.forEach((t=>t(a,e)))}},s=()=>a,c={setState:n,getState:s,subscribe:(e,n,c)=>n||c?((e,n=s,c=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=n(a);function r(){const t=n(a);if(!c(o,t)){const a=o;e(o=t,a)}}return t.add(r),()=>t.delete(r)})(e,n,c):(t.add(e),()=>t.delete(e)),destroy:()=>t.clear()};return a=e(n,s,c),c}const O="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?o.useEffect:o.useLayoutEffect;var f=t(1952),y=t(6673),v=t(3905);function h(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var w={};function S(e){var a=e.components,t=h(e,["components"]);return(0,v.kt)("wrapper",Object.assign({},w,t,{components:a,mdxType:"MDXLayout"}),(0,v.kt)("h1",null,"Counter Example"),(0,v.kt)("p",null,"We establish a WebRTC connection using ",(0,v.kt)("a",Object.assign({parentName:"p"},{href:"https://github.com/feross/simple-peer"}),"simple-peer")," and use the data channel to synchronize the shared counter using ",(0,v.kt)("a",Object.assign({parentName:"p"},{href:"https://github.com/cocoss-org/co-share"}),"co-share"),".\nThis example strongly relates to the ",(0,v.kt)("a",Object.assign({parentName:"p"},{href:"https://cocoss-org.github.io/co-share/counter/"}),"co-share tutorial"),"."),(0,v.kt)("p",null,(0,v.kt)("em",{parentName:"p"},"If you use chrome, you can verify the webrtc connection under chrome://webrtc-internals/.")),(0,v.kt)("h1",null,"Source Code"),(0,v.kt)("p",null,(0,v.kt)("a",Object.assign({parentName:"p"},{href:"https://github.com/cocoss-org/co-share-peer/blob/master/examples/pages/counter.tsx"}),(0,v.kt)("inlineCode",{parentName:"a"},"counter.tsx"))),(0,v.kt)("pre",Object.assign({},{className:"language-typescript"}),(0,v.kt)("code",Object.assign({parentName:"pre"},{className:"language-typescript"}),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," optionsC1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Options")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    initiator",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token boolean"}),"true"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," optionsC2",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Options")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"function")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"Index")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"c1Root",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," receiveFromC1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," sendToC1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," c2Root",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," receiveFromC2",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," sendToC2",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"useMemo"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," toC1 ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"new")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"Subject"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token builtin"}),"any"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token operator"}),">")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," toC2 ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"new")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"Subject"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token builtin"}),"any"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token operator"}),">")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"return")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"new")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"RootStore")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"new")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token known-class-name class-name"}),"Map")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," toC2",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"val",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"any"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," toC1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"next"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"val",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"new")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"RootStore")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"new")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token known-class-name class-name"}),"Map")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," toC1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"val",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"any"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," toC2",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"next"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"val",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"return")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"global",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"window")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"!=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword null nil"}),"null")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"&&")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"\n                ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Suspense")," fallback",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Loading ..."'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"MasterCounterExamplePage"),"\n                            rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"c1Root",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n                            options",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"optionsC1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n                            receiveSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"receiveFromC2",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n                            sendSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"sendToC2",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n                        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Suspense"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),"div className",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"border flex-basis-0 border-dark h-100"')," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Suspense")," fallback",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Loading ..."'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"SlaveCounterExamplePage"),"\n                            rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"c2Root",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n                            options",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"optionsC2",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n                            receiveSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"receiveFromC1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n                            sendSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"sendToC1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n                        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Suspense"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," masterOptions",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Options")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    initiator",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token boolean"}),"true"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"function")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"empty"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"void")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token comment"}),"//empty"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"function")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"MasterCounterExamplePage")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    receiveSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n    sendSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n    rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"RootStore"),"\n    options",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Options"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function-variable function"}),"receiveSignal"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Observable"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"any"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function-variable function"}),"sendSignal"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"data",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"any"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"void"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," store ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"useMemo"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"if")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"!"),"rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"storeMap"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"has"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"counter"'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," store ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"new")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"CounterStore")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token number"}),"0"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n            rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"addStore"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"counter"'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"return")," store\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"else")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"return")," rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"storeMap"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"get"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"counter"'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword module"}),"as")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"CounterStore"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"usePeerConnection"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"masterOptions",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," receiveSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," sendSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," empty",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword nil"}),"undefined"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"return")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"CounterExamplePage")," store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," slaveOptions",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Options")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"function")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"SlaveCounterExamplePage")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    receiveSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n    sendSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n    rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"RootStore"),"\n    options",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Options"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function-variable function"}),"receiveSignal"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Observable"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"any"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function-variable function"}),"sendSignal"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"data",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"any"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"void"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"usePeerConnection"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"slaveOptions",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," receiveSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," sendSignal",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," empty",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword nil"}),"undefined"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," store ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"useStoreSubscription"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"counter"'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token number"}),"1000"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"value",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"number"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"new")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"CounterStore")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"value",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," rootStore",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"return")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"CounterExamplePage")," store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"function")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"CounterExamplePage")),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," store ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"CounterStore")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," useStoreState ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"useMemo"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token generic-function"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token function"}),"create"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token generic class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"\n                counter",(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token builtin"}),"number"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token operator"}),">"))),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"state"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"const")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," counter ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"useStoreState"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword control-flow"}),"return")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),"div className",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"p-3 d-flex flex-row align-items-center justify-content-center flex-grow-1"'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),"h1 className",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"mx-3"'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"counter",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),"h1",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),"button className",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"m-1 btn btn-outline-primary"')," onClick",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," store",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"increase"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n                ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+"),"\n            ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),"button",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"/"),"div",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),(0,v.kt)("p",null,(0,v.kt)("a",Object.assign({parentName:"p"},{href:"https://github.com/cocoss-org/co-share-peer/blob/master/examples/src/counter-store.ts"}),(0,v.kt)("inlineCode",{parentName:"a"},"counter-store.ts"))),(0,v.kt)("pre",Object.assign({},{className:"language-typescript"}),(0,v.kt)("code",Object.assign({parentName:"pre"},{className:"language-typescript"}),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword module"}),"export")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"class")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"CounterStore"))," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"extends")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token class-name"}),(0,v.kt)("span",Object.assign({parentName:"span"},{className:"token maybe-class-name"}),"Store"))," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"public")," subscriber",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Subscriber"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"CounterStore"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"number"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Subscriber"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"create"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"CounterStore"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"connection",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," accept",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," deny",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"accept"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"this"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"state"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"getState"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"counter"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"public")," state",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"StoreApi"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," counter",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"number")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"public")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"onUnlink"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"link",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"StoreLink"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"void")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"public")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"onLink"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"link",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"StoreLink"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"void")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"constructor"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"value",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"number"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"super"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"this"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"state")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token function"}),"create"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," counter",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," value ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    increase ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token maybe-class-name"}),"Action"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"create"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"this"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"incr"'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"origin",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token arrow operator"}),"=>")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"this"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"increase"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"publishTo"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"origin ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"==")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword null nil"}),"null")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"?")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," to",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"all"')," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," to",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token string"}),'"all-except-one"'),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," except",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," origin ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"this"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"state"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"setState"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n            counter",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),":")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"this"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"state"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token method function property-access"}),"getState"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token property-access"}),"counter")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token number"}),"1"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),","),"\n        ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n",(0,v.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n")))}function x(){return(0,n.jsxs)("div",{className:"d-flex flex-column fullscreen",children:[(0,n.jsx)(f.h,{selectedIndex:0}),(0,n.jsxs)("div",{className:"d-flex flex-column justify-content-stretch container-lg",children:[(0,n.jsx)("div",{style:{height:"calc(90vh - 176px)"},className:"d-flex flex-row-responsive border mt-3",children:(0,n.jsx)(P,{})}),(0,n.jsx)("div",{className:"p-3 flex-basis-0 flex-grow-1",children:(0,n.jsx)(S,{})})]}),(0,n.jsx)(y.$,{})]})}S.isMDXComponent=!0;var _={initiator:!0,observeStreams:!1},C={observeStreams:!1};function P(){var e=(0,o.useMemo)((function(){var e=new g.x,a=new g.x;return[new r.RootStore(new Map),function(){return a},function(a){return e.next(a)},new r.RootStore(new Map),function(){return e},function(e){return a.next(e)}]}),[]),a=e[0],s=e[1],c=e[2],p=e[3],i=e[4],m=e[5];return(0,n.jsx)(n.Fragment,{children:null!=t.g.window&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Suspense,{fallback:"Loading ...",children:(0,n.jsx)(R,{rootStore:a,options:_,receiveSignal:i,sendSignal:m})}),(0,n.jsx)("div",{className:"border flex-basis-0 border-dark h-100"}),(0,n.jsx)(o.Suspense,{fallback:"Loading ...",children:(0,n.jsx)(A,{rootStore:p,options:C,receiveSignal:s,sendSignal:c})})]})})}var E={initiator:!0,observeStreams:!1};function M(){}function R(e){var a=e.receiveSignal,t=e.sendSignal,c=e.rootStore,r=(0,o.useMemo)((function(){if(c.storeMap.has("counter"))return c.storeMap.get("counter");var e=new b(0);return c.addStore(e,"counter"),e}),[c]);return(0,s.usePeerConnection)(E,a,t,M,void 0,c),(0,n.jsx)(D,{store:r})}var T={observeStreams:!1};function A(e){var a=e.receiveSignal,t=e.sendSignal,o=e.rootStore;(0,s.usePeerConnection)(T,a,t,M,void 0,o);var r=(0,c.useStoreSubscription)("counter",1e3,(function(e){return new b(e)}),[],o);return(0,n.jsx)(D,{store:r})}function D(e){var a=e.store,t=(0,o.useMemo)((function(){return function(e){const a="function"===typeof e?j(e):e,t=(e=a.getState,t=Object.is)=>{const[,n]=(0,o.useReducer)((e=>e+1),0),s=a.getState(),c=(0,o.useRef)(s),r=(0,o.useRef)(e),p=(0,o.useRef)(t),i=(0,o.useRef)(!1),m=(0,o.useRef)();let k;void 0===m.current&&(m.current=e(s));let N=!1;(c.current!==s||r.current!==e||p.current!==t||i.current)&&(k=e(s),N=!t(m.current,k)),O((()=>{N&&(m.current=k),c.current=s,r.current=e,p.current=t,i.current=!1}));const u=(0,o.useRef)(s);O((()=>{const e=()=>{try{const e=a.getState(),t=r.current(e);p.current(m.current,t)||(c.current=e,m.current=t,n())}catch(e){i.current=!0,n()}},t=a.subscribe(e);return a.getState()!==u.current&&e(),t}),[]);const l=N?k:m.current;return(0,o.useDebugValue)(l),l};return Object.assign(t,a),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[t,a];return{next(){const a=e.length<=0;return{value:e.shift(),done:a}}}},t}(a.state)}),[a])().counter;return(0,n.jsxs)("div",{className:"p-3 d-flex flex-row align-items-center justify-content-center flex-grow-1",children:[(0,n.jsx)("h1",{className:"mx-3",children:t}),(0,n.jsx)("button",{className:"m-1 btn btn-outline-primary",onClick:function(){return a.increase()},children:"+"})]})}},3545:function(e,a,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,a,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return a[t]}})}:function(e,a,t,n){void 0===n&&(n=t),e[n]=a[t]}),s=this&&this.__exportStar||function(e,a){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(a,t)||n(a,e,t)};Object.defineProperty(a,"__esModule",{value:!0}),s(t(1523),a)},1523:function(e,a,t){"use strict";var n=this&&this.__spreadArray||function(e,a,t){if(t||2===arguments.length)for(var n,s=0,c=a.length;s<c;s++)!n&&s in a||(n||(n=Array.prototype.slice.call(a,0,s)),n[s]=a[s]);return e.concat(n||Array.prototype.slice.call(a))};Object.defineProperty(a,"__esModule",{value:!0}),a.useStoreSubscription=void 0;var s=t(7378),c=t(2937),o=t(9978),r=t(4487),p=t(1687),i=Symbol();a.useStoreSubscription=function(e,a,t,m,k,N){void 0===k&&(k=p.rootStore),void 0===N&&(N=k.mainLink);var u=(0,r.suspend)((function(){return(0,c.firstValueFrom)(k.subscribe(e,N,t).pipe((0,o.retryWhen)((function(e){return e.pipe((0,o.delay)(a))})),(0,o.map)((function(e){return{store:e[0],storeLink:e[1],referenceCount:0}}))))}),n(n([a,e,k,N],null!==m&&void 0!==m?m:[],!0),[i],!1));return(0,s.useEffect)((function(){return u.referenceCount+=1,function(){u.referenceCount-=1,0===u.referenceCount&&(p.UnsubscribeAction.publishTo([u.storeLink]),k.destroyStore(u.store,e),(0,r.clear)(n(n([a,e,k,N],null!==m&&void 0!==m?m:[],!0),[i],!1)))}}),[u]),u.store}},471:function(){},1632:function(){}},function(e){e.O(0,[167,858,774,888,179],(function(){return a=7017,e(e.s=a);var a}));var a=e.O();_N_E=a}]);